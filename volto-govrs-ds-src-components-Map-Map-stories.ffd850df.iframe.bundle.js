"use strict";(self.webpackChunk_plone_volto=self.webpackChunk_plone_volto||[]).push([[6992],{"../../../packages/volto-govrs-ds/src/components/Map/Map.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MapDocs:function(){return MapDocs},MapInterativo:function(){return MapInterativo},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return Map_stories}});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),objectSpread2=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),esm=__webpack_require__("../../../node_modules/.pnpm/@react-google-maps+api@2.20.8_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/@react-google-maps/api/dist/esm.js"),objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.6/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),process=__webpack_require__("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");const _excluded=["apiKey","libraries","children","devMode"];var __jsx=react.createElement;const MapContext=(0,react.createContext)({isLoaded:!1,loadError:null,apiKey:null,devMode:!1});function MapProvider(_ref){let{apiKey:apiKey,libraries:libraries=["places"],children:children,devMode:devModeProp=!1}=_ref,loadOptions=(0,objectWithoutProperties.c)(_ref,_excluded);const key=(apiKey||process.env.REACT_APP_GOOGLE_MAPS_API_KEY||process.env.VITE_GOOGLE_MAPS_KEY||"").trim()||null,safeKey=key||" ",{isLoaded:isLoaded,loadError:loadError}=(0,esm.s1)((0,objectSpread2.c)({googleMapsApiKey:safeKey,libraries:libraries},loadOptions));return __jsx(MapContext.Provider,{value:{isLoaded:isLoaded,loadError:key?loadError:new Error("Google Maps API key is missing"),apiKey:key,devMode:devModeProp}},children)}MapProvider.__docgenInfo={description:"",methods:[],displayName:"MapProvider",props:{libraries:{defaultValue:{value:"['places']",computed:!1},required:!1},devMode:{defaultValue:{value:"false",computed:!1},required:!1}}};var MapWithMarkers_jsx=react.createElement;const containerStyle={width:"100%",height:"400px"},buildSvgPin=n=>{const label=String(n);return`data:image/svg+xml;utf8,${encodeURIComponent(`<?xml version="1.0" encoding="UTF-8"?>\n<svg width="40" height="56" viewBox="0 0 40 56" xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <filter id="shadow" x="-20%" y="-10%" width="140%" height="140%">\n      <feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#0f4b7a" flood-opacity="0.35"/>\n    </filter>\n  </defs>\n  <g filter="url(#shadow)">\n    <path d="M20 1C10.059 1 2 9.059 2 19c0 11.5 13.341 28.503 17.24 33.218a1 1 0 0 0 1.52 0C24.659 47.503 38 30.5 38 19 38 9.059 29.941 1 20 1Z" fill="#1c7ed6" stroke="#0f4b7a" stroke-width="2"/>\n  </g>\n  <text x="20" y="24" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="18" font-weight="700">${label}</text>\n</svg>`)}`};function MapWithMarkers({center:center={lat:-23.55,lng:-46.64},zoom:zoom=12,markers:markers=[],editable:editable=!0,onMarkersChange:onMarkersChange=()=>{},mapOptions:mapOptions={},showMarkerList:showMarkerList=!1,markerListLabel:markerListLabel="Todos os lugares",selectedMarkerId:selectedMarkerId,onMarkerSelect:onMarkerSelect}){const{isLoaded:isLoaded,apiKey:apiKey,devMode:devMode,loadError:loadError}=(0,react.useContext)(MapContext),mapRef=(0,react.useRef)(null),{0:localSelectedId,1:setLocalSelectedId}=(0,react.useState)(selectedMarkerId||null),isControlled=null!=selectedMarkerId,effectiveSelectedId=isControlled?selectedMarkerId:localSelectedId;(0,react.useEffect)(()=>{isControlled||!localSelectedId&&markers.length&&setLocalSelectedId(markers[0].id)},[isControlled,localSelectedId,markers]),(0,react.useEffect)(()=>{if(!mapRef.current)return;if(!effectiveSelectedId)return;const target=markers.find(m=>m.id===effectiveSelectedId);target&&mapRef.current.panTo({lat:target.lat,lng:target.lng})},[effectiveSelectedId,markers]);const handleMapClick=(0,react.useCallback)(e=>{if(!editable)return;const newMarker={id:Date.now().toString(),lat:e.latLng.lat(),lng:e.latLng.lng()};onMarkersChange([...markers,newMarker])},[editable,markers,onMarkersChange]),handleDragEnd=(0,react.useCallback)((e,id)=>{const updated=markers.map(m=>m.id===id?(0,objectSpread2.c)((0,objectSpread2.c)({},m),{},{lat:e.latLng.lat(),lng:e.latLng.lng()}):m);onMarkersChange(updated)},[markers,onMarkersChange]),handleMarkerSelect=(0,react.useCallback)(id=>{id&&(isControlled||setLocalSelectedId(id),null==onMarkerSelect||onMarkerSelect(id))},[isControlled,onMarkerSelect]),decoratedMarkers=(0,react.useMemo)(()=>markers.map((m,idx)=>(0,objectSpread2.c)((0,objectSpread2.c)({},m),{},{icon:{url:buildSvgPin(idx+1),scaledSize:{width:36,height:52},anchor:{x:18,y:52}},listLabel:`${idx+1}. ${m.title||"Local"}`})),[markers]),markerOptions=(0,react.useMemo)(()=>decoratedMarkers.map(m=>({value:m.id,label:m.listLabel})),[decoratedMarkers]);return apiKey?devMode?MapWithMarkers_jsx("div",null,"Dev mode ativado. Informe uma Google Maps API key para renderizar o mapa real."):loadError?MapWithMarkers_jsx("div",null,"Erro ao carregar mapa."):isLoaded?MapWithMarkers_jsx("div",null,MapWithMarkers_jsx(esm.ik,{mapContainerStyle:containerStyle,center:center,zoom:zoom,onClick:handleMapClick,options:mapOptions,onLoad:map=>{mapRef.current=map}},decoratedMarkers.map(m=>MapWithMarkers_jsx(esm.cK,{key:m.id,position:{lat:m.lat,lng:m.lng},draggable:editable,onDragEnd:e=>handleDragEnd(e,m.id),title:m.title,icon:m.icon}))),showMarkerList&&markerOptions.length>0&&MapWithMarkers_jsx("div",{style:{marginTop:12,border:"1px solid #d9d9d9",borderRadius:6,overflow:"hidden"}},MapWithMarkers_jsx("div",{style:{padding:"10px 12px",background:"#f5f5f5",fontWeight:600,color:"#444"}},markerListLabel),MapWithMarkers_jsx("select",{value:effectiveSelectedId||"",onChange:e=>handleMarkerSelect(e.target.value),style:{width:"100%",padding:"12px",border:"none",borderTop:"1px solid #e1e1e1",outline:"none"}},markerOptions.map(opt=>MapWithMarkers_jsx("option",{key:opt.value,value:opt.value},opt.label))))):MapWithMarkers_jsx("div",null,"Carregando mapa…"):MapWithMarkers_jsx("div",null,"Informe a Google Maps API key para carregar o mapa.")}MapWithMarkers.__docgenInfo={description:"",methods:[],displayName:"MapWithMarkers",props:{center:{defaultValue:{value:"{ lat: -23.55, lng: -46.64 }",computed:!1},required:!1},zoom:{defaultValue:{value:"12",computed:!1},required:!1},markers:{defaultValue:{value:"[]",computed:!1},required:!1},editable:{defaultValue:{value:"true",computed:!1},required:!1},onMarkersChange:{defaultValue:{value:"() => {}",computed:!1},required:!1},mapOptions:{defaultValue:{value:"{}",computed:!1},required:!1},showMarkerList:{defaultValue:{value:"false",computed:!1},required:!1},markerListLabel:{defaultValue:{value:"'Todos os lugares'",computed:!1},required:!1}}};var Map_stories_process=__webpack_require__("../../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"),Map_stories_jsx=react.createElement,Map_stories={title:"Components/Map"};const storybookApiKey=(Map_stories_process.env.STORYBOOK_GOOGLE_MAPS_API_KEY||Map_stories_process.env.REACT_APP_GOOGLE_MAPS_API_KEY||Map_stories_process.env.VITE_GOOGLE_MAPS_KEY||"").trim()||null,Template=props=>Map_stories_jsx(MapWithMarkers,props),MapDocs=()=>Map_stories_jsx("div",{style:{padding:16,maxWidth:920}},Map_stories_jsx("h1",null,"MapWithMarkers — Documentação"),Map_stories_jsx("section",{style:{marginTop:8}},Map_stories_jsx("h2",null,"Visão geral"),Map_stories_jsx("p",null,"O componente ",Map_stories_jsx("code",null,"MapWithMarkers")," renderiza um mapa do Google Maps com marcadores numerados. Passe a lista de locais via prop"," ",Map_stories_jsx("code",null,"markers")," para controlar quais pontos são mostrados. Cada item do array deve ser um objeto com",Map_stories_jsx("code",null,"id"),", ",Map_stories_jsx("code",null,"lat"),", ",Map_stories_jsx("code",null,"lng")," e opcionalmente"," ",Map_stories_jsx("code",null,"title"),".")),Map_stories_jsx("section",{style:{marginTop:12}},Map_stories_jsx("h2",null,"Exemplo de uso"),Map_stories_jsx("pre",{style:{background:"#f7f7f7",padding:12,borderRadius:4,overflowX:"auto"}},Map_stories_jsx("code",null,"const markers = [\n  { id: 'm1', lat: -30.0335, lng: -51.2304, title: 'Procergs' },\n  { id: 'm2', lat: -30.037, lng: -51.215, title: 'Procergs 2' },\n];\n\n<MapProvider apiKey={process.env.STORYBOOK_GOOGLE_MAPS_API_KEY}>\n  <MapWithMarkers markers={markers} showMarkerList markerListLabel=\"Todos os lugares\" />\n</MapProvider>"))),Map_stories_jsx("section",{style:{marginTop:12}},Map_stories_jsx("h2",null,"Props"),Map_stories_jsx("ul",null,Map_stories_jsx("li",null,Map_stories_jsx("code",null,"markers"),": ",Map_stories_jsx("strong",null,"required")," — array de objetos"," ","{ id, lat, lng, title? }","."),Map_stories_jsx("li",null,Map_stories_jsx("code",null,"center"),": centro inicial do mapa (objeto `","{ lat, lng }","`), padrão Porto Alegre."),Map_stories_jsx("li",null,Map_stories_jsx("code",null,"zoom"),": nível de zoom inicial (padrão 13)."),Map_stories_jsx("li",null,Map_stories_jsx("code",null,"editable"),": permite adicionar/arrastar marcadores (boolean)."),Map_stories_jsx("li",null,Map_stories_jsx("code",null,"showMarkerList"),": exibe um select com os marcadores.")))),MapInterativo=args=>{const apiKey=(0,react.useMemo)(()=>storybookApiKey,[]);return Map_stories_jsx("div",{style:{position:"relative"}},Map_stories_jsx(MapProvider,{apiKey:apiKey,devMode:!1},Map_stories_jsx(Template,args)))};MapInterativo.args={center:{lat:-30.0335,lng:-51.2204},zoom:13,editable:!1,showMarkerList:!0,markerListLabel:"Todos os lugares",markers:[{id:"m1",lat:-30.0335,lng:-51.2304,title:"Procergs"},{id:"m2",lat:-30.037,lng:-51.215,title:"Procergs 2"},{id:"m3",lat:-30.047,lng:-51.22,title:"Procergs 3"}]};const __namedExportsOrder=["MapDocs","MapInterativo"];MapDocs.parameters={...MapDocs.parameters,docs:{...MapDocs.parameters?.docs,source:{originalSource:"() => {\n  return <div style={{\n    padding: 16,\n    maxWidth: 920\n  }}>\n      <h1>MapWithMarkers — Documentação</h1>\n\n      <section style={{\n      marginTop: 8\n    }}>\n        <h2>Visão geral</h2>\n        <p>\n          O componente <code>MapWithMarkers</code> renderiza um mapa do Google\n          Maps com marcadores numerados. Passe a lista de locais via prop{' '}\n          <code>markers</code> para controlar quais pontos são mostrados. Cada\n          item do array deve ser um objeto com\n          <code>id</code>, <code>lat</code>, <code>lng</code> e opcionalmente{' '}\n          <code>title</code>.\n        </p>\n      </section>\n\n      <section style={{\n      marginTop: 12\n    }}>\n        <h2>Exemplo de uso</h2>\n        <pre style={{\n        background: '#f7f7f7',\n        padding: 12,\n        borderRadius: 4,\n        overflowX: 'auto'\n      }}>\n          <code>{`const markers = [\n  { id: 'm1', lat: -30.0335, lng: -51.2304, title: 'Procergs' },\n  { id: 'm2', lat: -30.037, lng: -51.215, title: 'Procergs 2' },\n];\n\n<MapProvider apiKey={process.env.STORYBOOK_GOOGLE_MAPS_API_KEY}>\n  <MapWithMarkers markers={markers} showMarkerList markerListLabel=\"Todos os lugares\" />\n</MapProvider>`}</code>\n        </pre>\n      </section>\n\n      <section style={{\n      marginTop: 12\n    }}>\n        <h2>Props</h2>\n        <ul>\n          <li>\n            <code>markers</code>: <strong>required</strong> — array de objetos{' '}\n            {`{ id, lat, lng, title? }`}.\n          </li>\n          <li>\n            <code>center</code>: centro inicial do mapa (objeto `\n            {`{ lat, lng }`}`), padrão Porto Alegre.\n          </li>\n          <li>\n            <code>zoom</code>: nível de zoom inicial (padrão 13).\n          </li>\n          <li>\n            <code>editable</code>: permite adicionar/arrastar marcadores\n            (boolean).\n          </li>\n          <li>\n            <code>showMarkerList</code>: exibe um select com os marcadores.\n          </li>\n        </ul>\n      </section>\n    </div>;\n}",...MapDocs.parameters?.docs?.source}}},MapInterativo.parameters={...MapInterativo.parameters,docs:{...MapInterativo.parameters?.docs,source:{originalSource:"args => {\n  const apiKey = useMemo(() => storybookApiKey, []);\n  return <div style={{\n    position: 'relative'\n  }}>\n      <MapProvider apiKey={apiKey} devMode={false}>\n        <Template {...args} />\n      </MapProvider>\n    </div>;\n}",...MapInterativo.parameters?.docs?.source}}}}}]);